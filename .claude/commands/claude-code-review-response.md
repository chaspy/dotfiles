# PRレビューコメント対応

現在のブランチに該当するPRのClaude Code Actionからのレビューコメントを取得し、各コメントに対応します。

## プロセス

1. **現在のPR情報を取得**
   - `gh pr view` で現在のブランチのPR情報を取得
   - PR番号とタイトルを確認
   - PRの状態とレビュー状況を確認

2. **レビューコメントの分析**
   - `gh pr view --comments` でPRのコメントを取得
   - `gh api repos/{owner}/{repo}/pulls/{pr_number}/reviews` でレビュー詳細を取得
   - Claude Code Actionからのコメントを特定
   - 未解決のコメントをフィルタリング

3. **コメント分類と優先度設定**
   - セキュリティ関連：高優先度
   - バグ・エラー修正：高優先度
   - パフォーマンス改善：中優先度
   - コードスタイル・リファクタリング：低優先度
   - ドキュメント・コメント：低優先度

4. **各コメントへの対応**
   - ファイルの場所とコンテキストを確認
   - 指摘されたコードを読み取り
   - 適切な修正方法を提案・実装
   - 修正が困難な場合は代替案を提示

5. **修正内容の確認**
   - 修正されたコードのテスト実行
   - lintやtype checkの実行
   - 修正が他の部分に影響しないか確認

6. **レビュー対応のコミット**
   - 各修正に対する適切なコミットメッセージを作成
   - 必要に応じて複数のコミットに分割
   - レビューコメントへの返信内容を準備

7. **修正結果の報告**
   - 対応したレビューコメントごとに修正内容をまとめ
   - `@claude` メンションをつけてPRコメントで報告
   - 各修正のコミットハッシュと変更ファイルを明記
   - 対応済みレビューコメントを解決としてマーク
   - 修正困難だった項目については理由と代替案を報告

## 特徴

- Claude Code Actionの自動レビューコメントに特化
- セキュリティとバグ修正を最優先で対応
- 修正の影響範囲を慎重に検討
- レビュワーが理解しやすい修正とコミットメッセージ
- 修正困難な場合の代替案提示
- @claude メンションによる自動報告とレビューコメント解決

## 対応する典型的なレビューコメント

- **セキュリティ**: 機密情報の露出、認証・認可の問題
- **エラーハンドリング**: 例外処理の不備、エラーの適切な処理
- **パフォーマンス**: 非効率なアルゴリズム、メモリリーク
- **可読性**: 複雑すぎる関数、不適切な命名
- **テスト**: テストケースの不足、テストの品質
- **依存関係**: 脆弱性のあるライブラリ、非推奨API

## 使用例

```bash
# 現在のブランチのPRレビューコメントに対応
/claude-code-review-response

# 特定の優先度以上のコメントのみ対応
/claude-code-review-response --priority high

# 特定のレビューIDのコメントのみ対応
/claude-code-review-response --review-id 12345
```

## 注意事項

- 修正前に必ずコードの全体的なコンテキストを理解する
- セキュリティ関連の修正は特に慎重に行う
- テストが失敗する修正は避ける
- 大幅な変更が必要な場合は段階的に実施
- レビュワーとの議論が必要な場合は適切に返信を準備